<?xml version="1.0" encoding="UTF-8"?>
<questions id="1_0_1_3_1_2_7" name="chap10WebSockets" nofquestions="6" nofsubcategories="0" filename="chap10websockets1_0_1_3_1_2_7.xml">
  <question id="1_0_1_3_1_2_7:0" type="2">
    <questiontext>&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;What&amp;nbsp;new&amp;nbsp;apis&amp;nbsp;are&amp;nbsp;present&amp;nbsp;in&amp;nbsp;HTML&amp;nbsp;5&amp;nbsp;specification&amp;nbsp;except&amp;nbsp;WebSocket&amp;nbsp;?&amp;nbsp;&lt;br&gt;
&amp;nbsp;&amp;nbsp;</questiontext>
    <questionanswer>W3C&amp;nbsp;Standards&amp;nbsp;:&amp;nbsp;&lt;br&gt;
&lt;br&gt;
Audio&amp;nbsp;&lt;br&gt;
Canvas&amp;nbsp;+&lt;br&gt;
CORS&amp;nbsp;+&lt;br&gt;
File&amp;nbsp;API&amp;nbsp;&lt;br&gt;
Geolocation&amp;nbsp;+&lt;br&gt;
IndexedDB&amp;nbsp;+&amp;nbsp;&lt;br&gt;
Microdata&lt;br&gt;
SVG&amp;nbsp;&lt;br&gt;
Video&amp;nbsp;+&lt;br&gt;
WebRTC&amp;nbsp;+&lt;br&gt;
WebSocket&amp;nbsp;&lt;br&gt;
Web&amp;nbsp;messaging&amp;nbsp;&lt;br&gt;
Web&amp;nbsp;storage&amp;nbsp;+&lt;br&gt;
Web&amp;nbsp;worker&amp;nbsp;+&lt;br&gt;
XMLHttpRequest&amp;nbsp;+&lt;br&gt;
WebGL&amp;nbsp;+</questionanswer>
  </question>
  <question id="1_0_1_3_1_2_7:1" type="2">
    <questiontext>&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Ajax&amp;nbsp;vs&amp;nbsp;Commet&amp;nbsp;vs&amp;nbsp;WebSocket&amp;nbsp;vs&amp;nbsp;Server-Sent&amp;nbsp;Event,&amp;nbsp;describe.&lt;br&gt;
&amp;nbsp;&amp;nbsp;</questiontext>
    <questionanswer>&lt;img&amp;nbsp;width='650'&amp;nbsp;height='500'&amp;nbsp;alt='image'&amp;nbsp;src='/data/images/Selection_009.png'/&gt;&lt;br&gt;
&lt;br&gt;
Frequent&amp;nbsp;Polling&amp;nbsp;:&amp;nbsp;&lt;br&gt;
&lt;img&amp;nbsp;width='650'&amp;nbsp;height='600'&amp;nbsp;alt='image'&amp;nbsp;src='/data/images/Selection_010.png'/&gt;&lt;br&gt;
&lt;br&gt;
&lt;img&amp;nbsp;width='650'&amp;nbsp;height='600'&amp;nbsp;alt='image'&amp;nbsp;src='/data/images/Selection_011.png'/&gt;&lt;br&gt;
&lt;br&gt;
&lt;img&amp;nbsp;width='660'&amp;nbsp;height='600'&amp;nbsp;alt='image'&amp;nbsp;src='/data/images/Selection_012.png'/&gt;&lt;br&gt;
&lt;br&gt;
&lt;img&amp;nbsp;width='670'&amp;nbsp;height='600'&amp;nbsp;alt='image'&amp;nbsp;src='/data/images/Selection_013.png'/&gt;&lt;br&gt;
&lt;br&gt;
&lt;img&amp;nbsp;width='650'&amp;nbsp;height='200'&amp;nbsp;alt='image'&amp;nbsp;src='/data/images/Selection_014.png'/&gt;</questionanswer>
  </question>
  <question id="1_0_1_3_1_2_7:2" type="2">
    <questiontext>&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Websocket&amp;nbsp;'handshake',&amp;nbsp;describe.&lt;br&gt;
&amp;nbsp;&amp;nbsp;</questiontext>
    <questionanswer>The&amp;nbsp;WebSocket&amp;nbsp;Protocol&lt;br&gt;
&lt;br&gt;
The&amp;nbsp;WebSocket&amp;nbsp;protocol&amp;nbsp;was&amp;nbsp;designed&amp;nbsp;to&amp;nbsp;work&amp;nbsp;well&amp;nbsp;with&amp;nbsp;the&amp;nbsp;existing&amp;nbsp;Web&amp;nbsp;infrastructure.&amp;nbsp;As&amp;nbsp;part&amp;nbsp;of&lt;br&gt;
this&amp;nbsp;design&amp;nbsp;principle,&amp;nbsp;the&amp;nbsp;protocol&amp;nbsp;specification&amp;nbsp;defines&amp;nbsp;that&amp;nbsp;the&amp;nbsp;WebSocket&amp;nbsp;connection&amp;nbsp;starts&amp;nbsp;its&lt;br&gt;
life&amp;nbsp;as&amp;nbsp;an&amp;nbsp;HTTP&amp;nbsp;connection,&amp;nbsp;guaranteeing&amp;nbsp;full&amp;nbsp;backwards&amp;nbsp;compatibility&amp;nbsp;with&amp;nbsp;the&amp;nbsp;pre-WebSocket&amp;nbsp;world.&lt;br&gt;
The&amp;nbsp;protocol&amp;nbsp;switch&amp;nbsp;from&amp;nbsp;HTTP&amp;nbsp;to&amp;nbsp;WebSocket&amp;nbsp;is&amp;nbsp;referred&amp;nbsp;to&amp;nbsp;as&amp;nbsp;a&amp;nbsp;the&amp;nbsp;WebSocket&amp;nbsp;__handshake__.&lt;br&gt;
The&amp;nbsp;browser&amp;nbsp;sends&amp;nbsp;a&amp;nbsp;request&amp;nbsp;to&amp;nbsp;the&amp;nbsp;server,&amp;nbsp;indicating&amp;nbsp;that&amp;nbsp;it&amp;nbsp;wants&amp;nbsp;to&amp;nbsp;switch&amp;nbsp;protocols&amp;nbsp;from&amp;nbsp;HTTP&amp;nbsp;to&lt;br&gt;
WebSocket.&amp;nbsp;The&amp;nbsp;client&amp;nbsp;expresses&amp;nbsp;its&amp;nbsp;desire&amp;nbsp;through&amp;nbsp;the&amp;nbsp;Upgrade&amp;nbsp;header:&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;GET&amp;nbsp;ws://echo.websocket.org/?encoding=text&amp;nbsp;HTTP/1.1&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Origin:&amp;nbsp;http://websocket.org&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Cookie:&amp;nbsp;__utma=99as&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Connection:&amp;nbsp;Upgrade&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Host:&amp;nbsp;echo.websocket.org&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Sec-WebSocket-Key:&amp;nbsp;uRovscZjNol/umbTt5uKmw==&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Upgrade:&amp;nbsp;websocket&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Sec-WebSocket-Version:&amp;nbsp;13&lt;br&gt;
&lt;br&gt;
If&amp;nbsp;the&amp;nbsp;server&amp;nbsp;understands&amp;nbsp;the&amp;nbsp;WebSocket&amp;nbsp;protocol,&amp;nbsp;it&amp;nbsp;agrees&amp;nbsp;to&amp;nbsp;the&amp;nbsp;protocol&amp;nbsp;switch&amp;nbsp;through&amp;nbsp;the&amp;nbsp;Upgrade&amp;nbsp;header.&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;HTTP/1.1&amp;nbsp;101&amp;nbsp;WebSocket&amp;nbsp;Protocol&amp;nbsp;Handshake&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Date:&amp;nbsp;Fri,&amp;nbsp;10&amp;nbsp;Feb&amp;nbsp;2012&amp;nbsp;17:38:18&amp;nbsp;GMT&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Connection:&amp;nbsp;Upgrade&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Server:&amp;nbsp;Kaazing&amp;nbsp;Gateway&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Upgrade:&amp;nbsp;WebSocket&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Access-Control-Allow-Origin:&amp;nbsp;http://websocket.org&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Access-Control-Allow-Credentials:&amp;nbsp;true&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Sec-WebSocket-Accept:&amp;nbsp;rLHCkw/SKsO9GAH/ZSFhBATDKrU=&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Access-Control-Allow-Headers:&amp;nbsp;content-type&lt;br&gt;
&lt;br&gt;
At&amp;nbsp;this&amp;nbsp;point&amp;nbsp;the&amp;nbsp;HTTP&amp;nbsp;connection&amp;nbsp;breaks&amp;nbsp;down&amp;nbsp;and&amp;nbsp;is&amp;nbsp;REPLACED&amp;nbsp;by&amp;nbsp;the&amp;nbsp;WebSocket&amp;nbsp;connection&amp;nbsp;over&lt;br&gt;
the&amp;nbsp;same&amp;nbsp;underlying&amp;nbsp;TCP/IP&amp;nbsp;connection.&amp;nbsp;The&amp;nbsp;WebSocket&amp;nbsp;connection&amp;nbsp;uses&amp;nbsp;the&amp;nbsp;same&amp;nbsp;ports&amp;nbsp;as&lt;br&gt;
HTTP&amp;nbsp;(80)&amp;nbsp;and&amp;nbsp;HTTPS&amp;nbsp;(443),&amp;nbsp;by&amp;nbsp;default.&lt;br&gt;
&lt;br&gt;
Once&amp;nbsp;established,&amp;nbsp;WebSocket&amp;nbsp;data&amp;nbsp;frames&amp;nbsp;can&amp;nbsp;be&amp;nbsp;sent&amp;nbsp;back&amp;nbsp;and&amp;nbsp;forth&amp;nbsp;between&amp;nbsp;the&amp;nbsp;client&amp;nbsp;and&amp;nbsp;the&lt;br&gt;
server&amp;nbsp;in&amp;nbsp;full-duplex&amp;nbsp;mode.&amp;nbsp;Both&amp;nbsp;text&amp;nbsp;and&amp;nbsp;binary&amp;nbsp;frames&amp;nbsp;can&amp;nbsp;be&amp;nbsp;sent&amp;nbsp;in&amp;nbsp;either&amp;nbsp;direction&amp;nbsp;at&lt;br&gt;
the&amp;nbsp;same&amp;nbsp;time.&amp;nbsp;The&amp;nbsp;data&amp;nbsp;is&amp;nbsp;minimally&amp;nbsp;framed&amp;nbsp;with&amp;nbsp;just&amp;nbsp;two&amp;nbsp;bytes.&amp;nbsp;In&amp;nbsp;the&amp;nbsp;case&amp;nbsp;of&amp;nbsp;text&amp;nbsp;frames,&lt;br&gt;
each&amp;nbsp;frame&amp;nbsp;starts&amp;nbsp;with&amp;nbsp;a&amp;nbsp;0x00&amp;nbsp;byte,&amp;nbsp;ends&amp;nbsp;with&amp;nbsp;a&amp;nbsp;0xFF&amp;nbsp;byte,&amp;nbsp;and&amp;nbsp;contains&amp;nbsp;UTF-8&amp;nbsp;data&amp;nbsp;in&amp;nbsp;between.&lt;br&gt;
WebSocket&amp;nbsp;text&amp;nbsp;frames&amp;nbsp;use&amp;nbsp;a&amp;nbsp;terminator,&amp;nbsp;while&amp;nbsp;binary&amp;nbsp;frames&amp;nbsp;use&amp;nbsp;a&amp;nbsp;length&amp;nbsp;prefix.&lt;br&gt;
&lt;br&gt;
==================================================&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Using&amp;nbsp;the&amp;nbsp;HTML5&amp;nbsp;WebSocket&amp;nbsp;API&lt;br&gt;
&lt;br&gt;
With&amp;nbsp;the&amp;nbsp;introduction&amp;nbsp;of&amp;nbsp;one&amp;nbsp;succinct&amp;nbsp;interface&amp;nbsp;(see&amp;nbsp;the&amp;nbsp;following&amp;nbsp;listing),&amp;nbsp;developers&amp;nbsp;can&amp;nbsp;replace&lt;br&gt;
techniques&amp;nbsp;such&amp;nbsp;as&amp;nbsp;long-polling&amp;nbsp;and&amp;nbsp;"forever&amp;nbsp;frames,"&amp;nbsp;and&amp;nbsp;as&amp;nbsp;a&amp;nbsp;result&amp;nbsp;further&amp;nbsp;reduce&amp;nbsp;latency.&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[Constructor(in&amp;nbsp;DOMString&amp;nbsp;url,&amp;nbsp;optional&amp;nbsp;in&amp;nbsp;DOMString&amp;nbsp;protocol)]&amp;nbsp;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;interface&amp;nbsp;WebSocket&amp;nbsp;{&amp;nbsp;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;readonly&amp;nbsp;attribute&amp;nbsp;DOMString&amp;nbsp;URL;&amp;nbsp;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;//&amp;nbsp;ready&amp;nbsp;state&amp;nbsp;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;const&amp;nbsp;unsigned&amp;nbsp;short&amp;nbsp;CONNECTING&amp;nbsp;=&amp;nbsp;0;&amp;nbsp;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;const&amp;nbsp;unsigned&amp;nbsp;short&amp;nbsp;OPEN&amp;nbsp;=&amp;nbsp;1;&amp;nbsp;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;const&amp;nbsp;unsigned&amp;nbsp;short&amp;nbsp;CLOSED&amp;nbsp;=&amp;nbsp;2;&amp;nbsp;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;readonly&amp;nbsp;attribute&amp;nbsp;unsigned&amp;nbsp;short&amp;nbsp;readyState;&amp;nbsp;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;readonly&amp;nbsp;attribute&amp;nbsp;unsigned&amp;nbsp;long&amp;nbsp;bufferedAmount;&amp;nbsp;&amp;nbsp;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;//&amp;nbsp;networking&amp;nbsp;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;attribute&amp;nbsp;Function&amp;nbsp;onopen;&amp;nbsp;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;attribute&amp;nbsp;Function&amp;nbsp;onmessage;&amp;nbsp;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;attribute&amp;nbsp;Function&amp;nbsp;onclose;&amp;nbsp;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;boolean&amp;nbsp;send(in&amp;nbsp;DOMString&amp;nbsp;data);&amp;nbsp;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;void&amp;nbsp;close();&amp;nbsp;};&amp;nbsp;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;WebSocket&amp;nbsp;implements&amp;nbsp;EventTarget;&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Utilizing&amp;nbsp;the&amp;nbsp;WebSocket&amp;nbsp;interface&amp;nbsp;couldn't&amp;nbsp;be&amp;nbsp;simpler.&amp;nbsp;To&amp;nbsp;connect&amp;nbsp;to&amp;nbsp;an&amp;nbsp;end-point,&amp;nbsp;just&lt;br&gt;
create&amp;nbsp;a&amp;nbsp;new&amp;nbsp;WebSocket&amp;nbsp;instance,&amp;nbsp;providing&amp;nbsp;the&amp;nbsp;new&amp;nbsp;object&amp;nbsp;with&amp;nbsp;a&amp;nbsp;URL&amp;nbsp;that&amp;nbsp;represents&amp;nbsp;the&lt;br&gt;
end-point&amp;nbsp;to&amp;nbsp;which&amp;nbsp;you&amp;nbsp;wish&amp;nbsp;to&amp;nbsp;connect,&amp;nbsp;as&amp;nbsp;shown&amp;nbsp;in&amp;nbsp;the&amp;nbsp;following&amp;nbsp;example.&lt;br&gt;
Note&amp;nbsp;that&amp;nbsp;a&amp;nbsp;ws://&amp;nbsp;and&amp;nbsp;wss://&amp;nbsp;prefix&amp;nbsp;are&amp;nbsp;proposed&amp;nbsp;to&amp;nbsp;indicate&amp;nbsp;a&amp;nbsp;WebSocket&amp;nbsp;and&amp;nbsp;a&amp;nbsp;secure&lt;br&gt;
WebSocket&amp;nbsp;connection,&amp;nbsp;respectively.&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;var&amp;nbsp;myWebSocket&amp;nbsp;=&amp;nbsp;new&amp;nbsp;WebSocket("ws://www.websockets.org");&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
A&amp;nbsp;WebSocket&amp;nbsp;connection&amp;nbsp;is&amp;nbsp;established&amp;nbsp;by&amp;nbsp;upgrading&amp;nbsp;from&amp;nbsp;the&amp;nbsp;HTTP&amp;nbsp;protocol&amp;nbsp;to&amp;nbsp;the&amp;nbsp;WebSockets&lt;br&gt;
protocol&amp;nbsp;during&amp;nbsp;the&amp;nbsp;initial&amp;nbsp;handshake&amp;nbsp;between&amp;nbsp;the&amp;nbsp;client&amp;nbsp;and&amp;nbsp;the&amp;nbsp;server.&amp;nbsp;The&amp;nbsp;connection&amp;nbsp;itself&lt;br&gt;
is&amp;nbsp;exposed&amp;nbsp;via&amp;nbsp;the&amp;nbsp;"onmessage"&amp;nbsp;and&amp;nbsp;"send"&amp;nbsp;functions&amp;nbsp;defined&amp;nbsp;by&amp;nbsp;the&amp;nbsp;WebSocket&amp;nbsp;interface.&lt;br&gt;
Before&amp;nbsp;connecting&amp;nbsp;to&amp;nbsp;an&amp;nbsp;end-point&amp;nbsp;and&amp;nbsp;sending&amp;nbsp;a&amp;nbsp;message,&amp;nbsp;you&amp;nbsp;can&amp;nbsp;associate&amp;nbsp;a&amp;nbsp;series&amp;nbsp;of&amp;nbsp;event&lt;br&gt;
listeners&amp;nbsp;to&amp;nbsp;handle&amp;nbsp;each&amp;nbsp;phase&amp;nbsp;of&amp;nbsp;the&amp;nbsp;connection&amp;nbsp;life-cycle&amp;nbsp;as&amp;nbsp;shown&amp;nbsp;in&amp;nbsp;the&amp;nbsp;following&amp;nbsp;example.&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;myWebSocket.onopen&amp;nbsp;=&amp;nbsp;function(evt)&amp;nbsp;{&amp;nbsp;alert("Connection&amp;nbsp;open&amp;nbsp;...");&amp;nbsp;};&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;myWebSocket.onmessage&amp;nbsp;=&amp;nbsp;function(evt)&amp;nbsp;{&amp;nbsp;alert(&amp;nbsp;"Received&amp;nbsp;Message:&amp;nbsp;"&amp;nbsp;+&amp;nbsp;evt.data);&amp;nbsp;};&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;myWebSocket.onclose&amp;nbsp;=&amp;nbsp;function(evt)&amp;nbsp;{&amp;nbsp;alert("Connection&amp;nbsp;closed.");&amp;nbsp;};&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
To&amp;nbsp;send&amp;nbsp;a&amp;nbsp;message&amp;nbsp;to&amp;nbsp;the&amp;nbsp;server,&amp;nbsp;simply&amp;nbsp;call&amp;nbsp;"send"&amp;nbsp;and&amp;nbsp;provide&amp;nbsp;the&amp;nbsp;content&amp;nbsp;you&amp;nbsp;wish&amp;nbsp;to&amp;nbsp;deliver.&lt;br&gt;
After&amp;nbsp;sending&amp;nbsp;the&amp;nbsp;message,&amp;nbsp;call&amp;nbsp;"close"&amp;nbsp;to&amp;nbsp;terminate&amp;nbsp;the&amp;nbsp;connection,&amp;nbsp;as&amp;nbsp;shown&amp;nbsp;in&amp;nbsp;the&amp;nbsp;following&lt;br&gt;
example.&amp;nbsp;As&amp;nbsp;you&amp;nbsp;can&amp;nbsp;see,&amp;nbsp;it&amp;nbsp;really&amp;nbsp;couldn't&amp;nbsp;be&amp;nbsp;much&amp;nbsp;easier.&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;myWebSocket.send("Hello&amp;nbsp;WebSockets!");&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;myWebSocket.close();</questionanswer>
  </question>
  <question id="1_0_1_3_1_2_7:3" type="2">
    <questiontext>&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Implementing&amp;nbsp;echo&amp;nbsp;server&amp;nbsp;using&amp;nbsp;java&amp;nbsp;Websocket,&amp;nbsp;describe.&lt;br&gt;
&amp;nbsp;&amp;nbsp;</questiontext>
    <questionanswer>1)&amp;nbsp;Server&amp;nbsp;(Java&amp;nbsp;part&amp;nbsp;,&amp;nbsp;Tomcat&amp;nbsp;has&amp;nbsp;own&amp;nbsp;WebSocket&amp;nbsp;libraries&amp;nbsp;,&amp;nbsp;be&amp;nbsp;careful&amp;nbsp;with&amp;nbsp;dependencies&amp;nbsp;conflicts)&lt;br&gt;
&lt;br&gt;
package&amp;nbsp;chap10;&lt;br&gt;
&lt;br&gt;
import&amp;nbsp;java.io.IOException;&lt;br&gt;
&lt;br&gt;
import&amp;nbsp;javax.websocket.OnClose;&lt;br&gt;
import&amp;nbsp;javax.websocket.OnMessage;&lt;br&gt;
import&amp;nbsp;javax.websocket.OnOpen;&lt;br&gt;
import&amp;nbsp;javax.websocket.Session;&lt;br&gt;
import&amp;nbsp;javax.websocket.server.ServerEndpoint;&lt;br&gt;
&lt;br&gt;
/**&lt;br&gt;
&amp;nbsp;*&amp;nbsp;@ServerEndpoint&amp;nbsp;gives&amp;nbsp;the&amp;nbsp;relative&amp;nbsp;name&amp;nbsp;for&amp;nbsp;the&amp;nbsp;end&amp;nbsp;point&amp;nbsp;This&amp;nbsp;will&amp;nbsp;be&lt;br&gt;
&amp;nbsp;*&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;accessed&amp;nbsp;via&amp;nbsp;ws://localhost:8080/EchoChamber/echo&amp;nbsp;Where&lt;br&gt;
&amp;nbsp;*&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;"localhost"&amp;nbsp;is&amp;nbsp;the&amp;nbsp;address&amp;nbsp;of&amp;nbsp;the&amp;nbsp;host,&amp;nbsp;"EchoChamber"&amp;nbsp;is&amp;nbsp;the&lt;br&gt;
&amp;nbsp;*&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;name&amp;nbsp;of&amp;nbsp;the&amp;nbsp;package&amp;nbsp;and&amp;nbsp;"echo"&amp;nbsp;is&amp;nbsp;the&amp;nbsp;address&amp;nbsp;to&amp;nbsp;access&amp;nbsp;this&lt;br&gt;
&amp;nbsp;*&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;class&amp;nbsp;from&amp;nbsp;the&amp;nbsp;server&lt;br&gt;
&amp;nbsp;*/&lt;br&gt;
&lt;br&gt;
@ServerEndpoint("/echo")&lt;br&gt;
public&amp;nbsp;class&amp;nbsp;EchoServer&amp;nbsp;{&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;/**&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;*&amp;nbsp;@OnOpen&amp;nbsp;allows&amp;nbsp;us&amp;nbsp;to&amp;nbsp;intercept&amp;nbsp;the&amp;nbsp;creation&amp;nbsp;of&amp;nbsp;a&amp;nbsp;new&amp;nbsp;session.&amp;nbsp;The&amp;nbsp;session&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;*&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;class&amp;nbsp;allows&amp;nbsp;us&amp;nbsp;to&amp;nbsp;send&amp;nbsp;data&amp;nbsp;to&amp;nbsp;the&amp;nbsp;user.&amp;nbsp;In&amp;nbsp;the&amp;nbsp;method&amp;nbsp;onOpen,&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;*&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;we'll&amp;nbsp;let&amp;nbsp;the&amp;nbsp;user&amp;nbsp;know&amp;nbsp;that&amp;nbsp;thehandshake&amp;nbsp;was&amp;nbsp;successful.&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;*/&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;@OnOpen&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;public&amp;nbsp;void&amp;nbsp;onOpen(Session&amp;nbsp;session)&amp;nbsp;{&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;System.out.println(session.getId()&amp;nbsp;+&amp;nbsp;"&amp;nbsp;has&amp;nbsp;opened&amp;nbsp;a&amp;nbsp;connection");&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;//class&amp;nbsp;org.apache.tomcat.websocket.WsSession&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;//System.out.println(session.getClass());&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;try&amp;nbsp;{&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;session.getBasicRemote().sendText("Connection&amp;nbsp;Established");&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&amp;nbsp;catch&amp;nbsp;(IOException&amp;nbsp;ex)&amp;nbsp;{&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;ex.printStackTrace();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;/**&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;*&amp;nbsp;When&amp;nbsp;a&amp;nbsp;user&amp;nbsp;sends&amp;nbsp;a&amp;nbsp;message&amp;nbsp;to&amp;nbsp;the&amp;nbsp;server,&amp;nbsp;this&amp;nbsp;method&amp;nbsp;will&amp;nbsp;intercept&amp;nbsp;the&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;*&amp;nbsp;message&amp;nbsp;and&amp;nbsp;allow&amp;nbsp;us&amp;nbsp;to&amp;nbsp;react&amp;nbsp;to&amp;nbsp;it.&amp;nbsp;For&amp;nbsp;now&amp;nbsp;the&amp;nbsp;message&amp;nbsp;is&amp;nbsp;read&amp;nbsp;as&amp;nbsp;a&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;*&amp;nbsp;String.&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;*/&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;@OnMessage&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;public&amp;nbsp;void&amp;nbsp;onMessage(String&amp;nbsp;message,&amp;nbsp;Session&amp;nbsp;session)&amp;nbsp;{&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;System.out.println("Message&amp;nbsp;from&amp;nbsp;"&amp;nbsp;+&amp;nbsp;session.getId()&amp;nbsp;+&amp;nbsp;":&amp;nbsp;"&amp;nbsp;+&amp;nbsp;message);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;System.out.println("There&amp;nbsp;are&amp;nbsp;N&amp;nbsp;of&amp;nbsp;connections&amp;nbsp;:&amp;nbsp;"&amp;nbsp;+&amp;nbsp;session.getOpenSessions().size());&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;try&amp;nbsp;{&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;//&amp;nbsp;With&amp;nbsp;this&amp;nbsp;snippet&amp;nbsp;it&amp;nbsp;will&amp;nbsp;be&amp;nbsp;hello&amp;nbsp;world&amp;nbsp;CHAT&lt;br&gt;
/*&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;for(Session&amp;nbsp;userSession&amp;nbsp;:&amp;nbsp;session.getOpenSessions()){&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;userSession.getBasicRemote().sendText(message);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}*/&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;session.getBasicRemote().sendText(message);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&amp;nbsp;catch&amp;nbsp;(IOException&amp;nbsp;ex)&amp;nbsp;{&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;ex.printStackTrace();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;/**&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;*&amp;nbsp;The&amp;nbsp;user&amp;nbsp;closes&amp;nbsp;the&amp;nbsp;connection.&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;*&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;*&amp;nbsp;Note:&amp;nbsp;you&amp;nbsp;can't&amp;nbsp;send&amp;nbsp;messages&amp;nbsp;to&amp;nbsp;the&amp;nbsp;client&amp;nbsp;from&amp;nbsp;this&amp;nbsp;method&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;*/&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;@OnClose&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;public&amp;nbsp;void&amp;nbsp;onClose(Session&amp;nbsp;session)&amp;nbsp;{&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;System.out.println("Session&amp;nbsp;"&amp;nbsp;+&amp;nbsp;session.getId()&amp;nbsp;+&amp;nbsp;"&amp;nbsp;has&amp;nbsp;ended");&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br&gt;
}&lt;br&gt;
&lt;br&gt;
2)&amp;nbsp;Client&amp;nbsp;side&amp;nbsp;(Js&amp;nbsp;WebSocket&amp;nbsp;object)&amp;nbsp;echoExample.jsp&amp;nbsp;:&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;div&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;input&amp;nbsp;type="text"&amp;nbsp;id="messageinput"&amp;nbsp;/&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;/div&gt;&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;div&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;button&amp;nbsp;type="button"&amp;nbsp;onclick="openSocket();"&gt;Open&lt;/button&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;button&amp;nbsp;type="button"&amp;nbsp;onclick="send();"&gt;Send&lt;/button&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;button&amp;nbsp;type="button"&amp;nbsp;onclick="closeSocket();"&gt;Close&lt;/button&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/div&gt;&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;!--&amp;nbsp;Server&amp;nbsp;responses&amp;nbsp;get&amp;nbsp;written&amp;nbsp;here&amp;nbsp;--&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;div&amp;nbsp;style="border:&amp;nbsp;1px&amp;nbsp;solid&amp;nbsp;red"&amp;nbsp;id="messages"&gt;&lt;/div&gt;&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;script&amp;nbsp;type="text/javascript"&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;var&amp;nbsp;webSocket;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;var&amp;nbsp;messages&amp;nbsp;=&amp;nbsp;document.getElementById("messages");&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;function&amp;nbsp;openSocket()&amp;nbsp;{&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;//&amp;nbsp;Ensures&amp;nbsp;only&amp;nbsp;one&amp;nbsp;connection&amp;nbsp;is&amp;nbsp;open&amp;nbsp;at&amp;nbsp;a&amp;nbsp;time&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if&amp;nbsp;(webSocket&amp;nbsp;!==&amp;nbsp;undefined&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;&amp;&amp;nbsp;webSocket.readyState&amp;nbsp;!==&amp;nbsp;WebSocket.CLOSED)&amp;nbsp;{&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;writeResponse("WebSocket&amp;nbsp;is&amp;nbsp;already&amp;nbsp;opened.");&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;return;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;//&amp;nbsp;Create&amp;nbsp;a&amp;nbsp;new&amp;nbsp;instance&amp;nbsp;of&amp;nbsp;the&amp;nbsp;websocket&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;webSocket&amp;nbsp;=&amp;nbsp;new&amp;nbsp;WebSocket("ws://localhost:8080/chap10WebSockets/echo");&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;/**&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;*&amp;nbsp;Binds&amp;nbsp;functions&amp;nbsp;to&amp;nbsp;the&amp;nbsp;listeners&amp;nbsp;for&amp;nbsp;the&amp;nbsp;websocket.&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;*/&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;webSocket.onopen&amp;nbsp;=&amp;nbsp;function(event)&amp;nbsp;{&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;//&amp;nbsp;For&amp;nbsp;reasons&amp;nbsp;I&amp;nbsp;can't&amp;nbsp;determine,&amp;nbsp;onopen&amp;nbsp;gets&amp;nbsp;called&amp;nbsp;twice&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;//&amp;nbsp;and&amp;nbsp;the&amp;nbsp;first&amp;nbsp;time&amp;nbsp;event.data&amp;nbsp;is&amp;nbsp;undefined.&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;//&amp;nbsp;Leave&amp;nbsp;a&amp;nbsp;comment&amp;nbsp;if&amp;nbsp;you&amp;nbsp;know&amp;nbsp;the&amp;nbsp;answer.&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if&amp;nbsp;(event.data&amp;nbsp;===&amp;nbsp;undefined)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;return;&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;writeResponse(event.data);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;};&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;webSocket.onmessage&amp;nbsp;=&amp;nbsp;function(event)&amp;nbsp;{&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;writeResponse(event.data);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;};&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;webSocket.onclose&amp;nbsp;=&amp;nbsp;function(event)&amp;nbsp;{&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;writeResponse("Connection&amp;nbsp;closed");&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;};&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;/**&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;*&amp;nbsp;Sends&amp;nbsp;the&amp;nbsp;value&amp;nbsp;of&amp;nbsp;the&amp;nbsp;text&amp;nbsp;input&amp;nbsp;to&amp;nbsp;the&amp;nbsp;server&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;*/&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;function&amp;nbsp;send()&amp;nbsp;{&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;var&amp;nbsp;text&amp;nbsp;=&amp;nbsp;document.getElementById("messageinput").value;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;webSocket.send(text);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;function&amp;nbsp;closeSocket()&amp;nbsp;{&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;webSocket.close();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;function&amp;nbsp;writeResponse(text)&amp;nbsp;{&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;messages.innerHTML&amp;nbsp;+=&amp;nbsp;"&lt;br/&gt;"&amp;nbsp;+&amp;nbsp;text;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/script&gt;&lt;br&gt;</questionanswer>
  </question>
  <question id="1_0_1_3_1_2_7:4" type="2">
    <questiontext>&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Describe&amp;nbsp;main&amp;nbsp;classes&amp;nbsp;from&amp;nbsp;Java&amp;nbsp;Websocket.&amp;nbsp;(JSR-356)&lt;br&gt;
&amp;nbsp;&amp;nbsp;</questiontext>
    <questionanswer>javax.WebSocket&amp;nbsp;package&amp;nbsp;:&amp;nbsp;&lt;br&gt;
&lt;br&gt;
Interface&amp;nbsp;Summary:&lt;br&gt;
&amp;nbsp;ClientEndpointConfig&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br&gt;
&amp;nbsp;CloseReason.CloseCode&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br&gt;
&amp;nbsp;Decoder&amp;nbsp;-&amp;nbsp;This&amp;nbsp;interface&amp;nbsp;defines&amp;nbsp;how&amp;nbsp;a&amp;nbsp;custom&amp;nbsp;object&amp;nbsp;(of&amp;nbsp;type&amp;nbsp;T)&amp;nbsp;is&amp;nbsp;decoded&amp;nbsp;from&amp;nbsp;a&amp;nbsp;web&amp;nbsp;socket&amp;nbsp;message&amp;nbsp;in&amp;nbsp;the&amp;nbsp;form&amp;nbsp;of&amp;nbsp;a&amp;nbsp;byte&amp;nbsp;buffer.&lt;br&gt;
&amp;nbsp;Decoder.Binary&lt;T&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br&gt;
&amp;nbsp;Decoder.BinaryStream&lt;T&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br&gt;
&amp;nbsp;Decoder.Text&lt;T&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br&gt;
&amp;nbsp;Decoder.TextStream&lt;T&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br&gt;
&amp;nbsp;Encoder&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br&gt;
&amp;nbsp;Encoder.Binary&lt;T&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br&gt;
&amp;nbsp;Encoder.BinaryStream&lt;T&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br&gt;
&amp;nbsp;Encoder.Text&lt;T&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br&gt;
&amp;nbsp;Encoder.TextStream&lt;T&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br&gt;
&amp;nbsp;EndpointConfig&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br&gt;
&amp;nbsp;Extension&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br&gt;
&amp;nbsp;Extension.Parameter&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br&gt;
&amp;nbsp;HandshakeResponse&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br&gt;
&amp;nbsp;MessageHandler&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br&gt;
&amp;nbsp;MessageHandler.Partial&lt;T&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br&gt;
&amp;nbsp;MessageHandler.Whole&lt;T&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br&gt;
&amp;nbsp;PongMessage&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br&gt;
&amp;nbsp;RemoteEndpoint&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br&gt;
&amp;nbsp;RemoteEndpoint.Async&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br&gt;
&amp;nbsp;RemoteEndpoint.Basic&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br&gt;
&amp;nbsp;SendHandler&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br&gt;
&amp;nbsp;Session&amp;nbsp;&amp;nbsp;-&amp;nbsp;A&amp;nbsp;Web&amp;nbsp;Socket&amp;nbsp;session&amp;nbsp;represents&amp;nbsp;a&amp;nbsp;conversation&amp;nbsp;between&amp;nbsp;two&amp;nbsp;web&amp;nbsp;socket&amp;nbsp;endpoints.&lt;br&gt;
&amp;nbsp;WebSocketContainer&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Class&amp;nbsp;Summary:&lt;br&gt;
&amp;nbsp;ClientEndpointConfig.Builder&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br&gt;
&amp;nbsp;ClientEndpointConfig.Configurator&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br&gt;
&amp;nbsp;CloseReason&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br&gt;
&amp;nbsp;ContainerProvider&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br&gt;
&amp;nbsp;Endpoint&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br&gt;
&amp;nbsp;SendResult&lt;br&gt;
&lt;br&gt;
Enum&amp;nbsp;Summary:&amp;nbsp;&lt;br&gt;
&amp;nbsp;CloseReason.CloseCodes&lt;br&gt;
&lt;br&gt;
Exception&amp;nbsp;Summary:&lt;br&gt;
&amp;nbsp;DecodeException&amp;nbsp;-&amp;nbsp;A&amp;nbsp;general&amp;nbsp;exception&amp;nbsp;that&amp;nbsp;occurs&amp;nbsp;when&amp;nbsp;trying&amp;nbsp;to&amp;nbsp;decode&amp;nbsp;a&amp;nbsp;custom&amp;nbsp;object&amp;nbsp;from&amp;nbsp;a&amp;nbsp;text&amp;nbsp;or&amp;nbsp;binary&amp;nbsp;message.&lt;br&gt;
&amp;nbsp;DeploymentException&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br&gt;
&amp;nbsp;EncodeException&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br&gt;
&amp;nbsp;SessionException&lt;br&gt;
&lt;br&gt;
Annotation&amp;nbsp;Types&amp;nbsp;Summary&amp;nbsp;:&lt;br&gt;
&amp;nbsp;ClientEndpoint&lt;br&gt;
&amp;nbsp;ServerEndpoint&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br&gt;
&amp;nbsp;OnClose&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br&gt;
&amp;nbsp;OnError&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br&gt;
&amp;nbsp;OnMessage&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br&gt;
&amp;nbsp;OnOpen</questionanswer>
  </question>
  <question id="1_0_1_3_1_2_7:5" type="2">
    <questiontext>&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Uploading&amp;nbsp;files&amp;nbsp;using&amp;nbsp;WebSockets,&amp;nbsp;describe.&amp;nbsp;(JS&amp;nbsp;and&amp;nbsp;Java)&lt;br&gt;
&amp;nbsp;&amp;nbsp;</questiontext>
    <questionanswer>1)&amp;nbsp;Java&amp;nbsp;serverendpoint&lt;br&gt;
&lt;br&gt;
package&amp;nbsp;chap10.filetransferwebsocket;&lt;br&gt;
&lt;br&gt;
import&amp;nbsp;java.io.File;&lt;br&gt;
import&amp;nbsp;java.io.FileNotFoundException;&lt;br&gt;
import&amp;nbsp;java.io.FileOutputStream;&lt;br&gt;
import&amp;nbsp;java.io.IOException;&lt;br&gt;
import&amp;nbsp;java.nio.ByteBuffer;&lt;br&gt;
&lt;br&gt;
import&amp;nbsp;javax.websocket.OnMessage;&lt;br&gt;
import&amp;nbsp;javax.websocket.Session;&lt;br&gt;
import&amp;nbsp;javax.websocket.server.ServerEndpoint;&lt;br&gt;
&lt;br&gt;
@ServerEndpoint("/fileServer")&lt;br&gt;
public&amp;nbsp;class&amp;nbsp;WebSocketFIleServer&amp;nbsp;{&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;static&amp;nbsp;File&amp;nbsp;uploadedFile&amp;nbsp;=&amp;nbsp;null;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;static&amp;nbsp;String&amp;nbsp;fileName&amp;nbsp;=&amp;nbsp;null;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;static&amp;nbsp;FileOutputStream&amp;nbsp;fos&amp;nbsp;=&amp;nbsp;null;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;final&amp;nbsp;static&amp;nbsp;String&amp;nbsp;filePath&amp;nbsp;=&amp;nbsp;"/home/andrew/Documents/";&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;@OnMessage&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;public&amp;nbsp;void&amp;nbsp;processUpload(ByteBuffer&amp;nbsp;msg,&amp;nbsp;boolean&amp;nbsp;last,&amp;nbsp;Session&amp;nbsp;session)&amp;nbsp;{&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;System.out.println("Binary&amp;nbsp;Data");&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;while&amp;nbsp;(msg.hasRemaining())&amp;nbsp;{&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;try&amp;nbsp;{&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;fos.write(msg.get());&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&amp;nbsp;catch&amp;nbsp;(IOException&amp;nbsp;e)&amp;nbsp;{&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;e.printStackTrace();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;@OnMessage&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;public&amp;nbsp;void&amp;nbsp;onMessage(Session&amp;nbsp;session,&amp;nbsp;String&amp;nbsp;msg)&amp;nbsp;{&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;System.out.println("Handling/saving&amp;nbsp;file");&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;//&amp;nbsp;System.out.println(message);&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;System.out.println("got&amp;nbsp;msg:&amp;nbsp;"&amp;nbsp;+&amp;nbsp;msg);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if&amp;nbsp;(!msg.equals("end"))&amp;nbsp;{&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;fileName&amp;nbsp;=&amp;nbsp;msg.substring(msg.indexOf(':')&amp;nbsp;+&amp;nbsp;1);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;uploadedFile&amp;nbsp;=&amp;nbsp;new&amp;nbsp;File(filePath&amp;nbsp;+&amp;nbsp;fileName);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;try&amp;nbsp;{&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;fos&amp;nbsp;=&amp;nbsp;new&amp;nbsp;FileOutputStream(uploadedFile);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&amp;nbsp;catch&amp;nbsp;(FileNotFoundException&amp;nbsp;e)&amp;nbsp;{&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;e.printStackTrace();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&amp;nbsp;else&amp;nbsp;{&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;try&amp;nbsp;{&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;fos.flush();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;fos.close();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&amp;nbsp;catch&amp;nbsp;(IOException&amp;nbsp;e)&amp;nbsp;{&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;e.printStackTrace();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br&gt;
&lt;br&gt;
}&lt;br&gt;
&lt;br&gt;
2)&amp;nbsp;JS&amp;nbsp;part&lt;br&gt;
....&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;button&amp;nbsp;id="openConnection"&gt;Open&amp;nbsp;Connection&lt;/button&gt;&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;div&amp;nbsp;id="fileArea"&amp;nbsp;style="display:none"&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;input&amp;nbsp;type="file"&amp;nbsp;id="filename"&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;button&amp;nbsp;id="performLoad"&gt;Load&amp;nbsp;file&lt;/button&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/div&gt;&lt;br&gt;
&lt;br&gt;
&lt;script&amp;nbsp;type="text/javascript"&amp;nbsp;src="jquery2.1.1.js"&gt;&lt;/script&gt;&lt;br&gt;
&lt;script&amp;nbsp;type="text/javascript"&gt;&lt;br&gt;
$(function(){&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;var&amp;nbsp;webSocket;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;console.log("loaded");&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;$("#openConnection").click(function(){&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;//alert("open");&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;webSocket&amp;nbsp;=&amp;nbsp;new&amp;nbsp;WebSocket("ws://localhost:8080/chap10WebSockets/fileServer");&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;webSocket.binaryType&amp;nbsp;=&amp;nbsp;'arraybuffer';&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;$("#fileArea").show();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;});&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;$("#performLoad").click(function(){&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;console.log("loading");&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;sendFile();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;});&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;function&amp;nbsp;sendFile()&amp;nbsp;{&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;var&amp;nbsp;file&amp;nbsp;=&amp;nbsp;document.getElementById('filename').files[0];&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;webSocket.send('filename:'+file.name);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;var&amp;nbsp;reader&amp;nbsp;=&amp;nbsp;new&amp;nbsp;FileReader();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;var&amp;nbsp;rawData&amp;nbsp;=&amp;nbsp;new&amp;nbsp;ArrayBuffer();&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;reader.loadend&amp;nbsp;=&amp;nbsp;function()&amp;nbsp;{&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;reader.onload&amp;nbsp;=&amp;nbsp;function(e)&amp;nbsp;{&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;rawData&amp;nbsp;=&amp;nbsp;e.target.result;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;webSocket.send(rawData);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;alert("the&amp;nbsp;File&amp;nbsp;has&amp;nbsp;been&amp;nbsp;transferred.");&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;webSocket.send('end');&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;reader.readAsArrayBuffer(file);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br&gt;
&lt;br&gt;
});&lt;br&gt;
&lt;/script&gt;&lt;br&gt;
&lt;br&gt;</questionanswer>
  </question>
</questions>
