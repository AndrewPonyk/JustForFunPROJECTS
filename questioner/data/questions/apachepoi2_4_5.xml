<?xml version="1.0" encoding="UTF-8"?>
<questions id="2_4_5" name="ApachePoi" nofquestions="1" nofsubcategories="0" filename="apachepoi2_4_5.xml">
  <question id="2_4_5:0" type="2">
    <questiontext>&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;How&amp;nbsp;to&amp;nbsp;create&amp;nbsp;word&amp;nbsp;doc(docx)&amp;nbsp;with&amp;nbsp;some&amp;nbsp;simple&amp;nbsp;text&amp;nbsp;using&amp;nbsp;Apache&amp;nbsp;POI&amp;nbsp;?&amp;nbsp;&lt;br&gt;
Provide&amp;nbsp;example&amp;nbsp;to&amp;nbsp;substitute&amp;nbsp;placeholders&amp;nbsp;like&amp;nbsp;${var}&amp;nbsp;in&amp;nbsp;docx&amp;nbsp;file&amp;nbsp;with&amp;nbsp;some&amp;nbsp;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;real&amp;nbsp;values.&lt;br&gt;
&amp;nbsp;&amp;nbsp;</questiontext>
    <questionanswer>Apache&amp;nbsp;POI,&amp;nbsp;a&amp;nbsp;project&amp;nbsp;run&amp;nbsp;by&amp;nbsp;the&amp;nbsp;Apache&amp;nbsp;Software&amp;nbsp;Foundation,&amp;nbsp;and&amp;nbsp;previously&lt;br&gt;
a&amp;nbsp;sub-project&amp;nbsp;of&amp;nbsp;the&amp;nbsp;Jakarta&amp;nbsp;Project,&amp;nbsp;provides&amp;nbsp;pure&amp;nbsp;Java&amp;nbsp;libraries&amp;nbsp;for&amp;nbsp;reading&amp;nbsp;and&amp;nbsp;writing&amp;nbsp;files&lt;br&gt;
in&amp;nbsp;Microsoft&amp;nbsp;Office&amp;nbsp;formats,&amp;nbsp;such&amp;nbsp;as&amp;nbsp;Word,&amp;nbsp;PowerPoint&amp;nbsp;and&amp;nbsp;Excel.&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Examples&amp;nbsp;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;1)&amp;nbsp;Create&amp;nbsp;simple&amp;nbsp;docx&amp;nbsp;file&amp;nbsp;with&amp;nbsp;some&amp;nbsp;text&lt;br&gt;
package&amp;nbsp;com.ap;&lt;br&gt;
&lt;br&gt;
import&amp;nbsp;org.apache.poi.xwpf.usermodel.Borders;&lt;br&gt;
import&amp;nbsp;org.apache.poi.xwpf.usermodel.XWPFDocument;&lt;br&gt;
import&amp;nbsp;org.apache.poi.xwpf.usermodel.XWPFParagraph;&lt;br&gt;
import&amp;nbsp;org.apache.poi.xwpf.usermodel.XWPFRun;&lt;br&gt;
&lt;br&gt;
import&amp;nbsp;java.io.File;&lt;br&gt;
import&amp;nbsp;java.io.FileOutputStream;&lt;br&gt;
import&amp;nbsp;java.io.IOException;&lt;br&gt;
&lt;br&gt;
/**&lt;br&gt;
&amp;nbsp;*&amp;nbsp;Created&amp;nbsp;by&amp;nbsp;aponyk&amp;nbsp;on&amp;nbsp;05.08.2016.&lt;br&gt;
&amp;nbsp;*/&lt;br&gt;
public&amp;nbsp;class&amp;nbsp;CreateDocumentWithSimpleParagraph&amp;nbsp;{&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;public&amp;nbsp;static&amp;nbsp;void&amp;nbsp;main(String[]&amp;nbsp;args)&amp;nbsp;throws&amp;nbsp;IOException&amp;nbsp;{&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;//D:\temp&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;XWPFDocument&amp;nbsp;document&amp;nbsp;=&amp;nbsp;new&amp;nbsp;XWPFDocument();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;FileOutputStream&amp;nbsp;out&amp;nbsp;=&amp;nbsp;new&amp;nbsp;FileOutputStream(&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;new&amp;nbsp;File("D:\\temp\\createdocument.docx"));&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;//create&amp;nbsp;Paragraph&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;XWPFParagraph&amp;nbsp;paragraph&amp;nbsp;=&amp;nbsp;document.createParagraph();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;XWPFRun&amp;nbsp;run=paragraph.createRun();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;run.setFontFamily("Castellar");&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;run.setFontSize(14);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;run.setText("At&amp;nbsp;tutorialspoint.com,&amp;nbsp;we&amp;nbsp;strive&amp;nbsp;hard&amp;nbsp;to&amp;nbsp;"&amp;nbsp;+&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;"provide&amp;nbsp;quality&amp;nbsp;tutorials&amp;nbsp;for&amp;nbsp;self-learning&amp;nbsp;"&amp;nbsp;+&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;"purpose&amp;nbsp;in&amp;nbsp;the&amp;nbsp;domains&amp;nbsp;of&amp;nbsp;Academics,&amp;nbsp;Information&amp;nbsp;"&amp;nbsp;+&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;"Technology,&amp;nbsp;Management&amp;nbsp;and&amp;nbsp;Computer&amp;nbsp;Programming&amp;nbsp;Languages.");&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;paragraph.setBorderLeft(Borders.BASIC_BLACK_SQUARES);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;paragraph.setBorderTop(Borders.BASIC_BLACK_DASHES);&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;document.write(out);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;out.close();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;System.out.println("createdocument.docx&amp;nbsp;written&amp;nbsp;successully");&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;document.close();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br&gt;
}&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;2)&amp;nbsp;Replace&amp;nbsp;placeholders&amp;nbsp;&lt;br&gt;
package&amp;nbsp;com.ap;&lt;br&gt;
&lt;br&gt;
import&amp;nbsp;org.apache.commons.lang3.text.StrSubstitutor;&lt;br&gt;
import&amp;nbsp;org.apache.poi.xwpf.usermodel.XWPFDocument;&lt;br&gt;
&lt;br&gt;
import&amp;nbsp;java.io.FileInputStream;&lt;br&gt;
import&amp;nbsp;java.io.FileOutputStream;&lt;br&gt;
import&amp;nbsp;java.io.IOException;&lt;br&gt;
import&amp;nbsp;java.util.HashMap;&lt;br&gt;
import&amp;nbsp;java.util.Map;&lt;br&gt;
import&amp;nbsp;java.util.Optional;&lt;br&gt;
&lt;br&gt;
/**&lt;br&gt;
&amp;nbsp;*&amp;nbsp;Created&amp;nbsp;by&amp;nbsp;aponyk&amp;nbsp;on&amp;nbsp;05.08.2016.&lt;br&gt;
&amp;nbsp;*/&lt;br&gt;
public&amp;nbsp;class&amp;nbsp;ModifyWordDoc&amp;nbsp;{&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;public&amp;nbsp;static&amp;nbsp;void&amp;nbsp;main(String[]&amp;nbsp;args)&amp;nbsp;throws&amp;nbsp;IOException&amp;nbsp;{&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;System.err.println("Modify&amp;nbsp;word&amp;nbsp;document");&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;XWPFDocument&amp;nbsp;doc&amp;nbsp;=&amp;nbsp;new&amp;nbsp;XWPFDocument(new&amp;nbsp;FileInputStream("/home/andrii/temp/ApachePoiExamples/letter-template.docx"));&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Map&lt;String,&amp;nbsp;String&gt;&amp;nbsp;values&amp;nbsp;=&amp;nbsp;new&amp;nbsp;HashMap&lt;&gt;();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;values.put("S2_R1_FName",&amp;nbsp;"Roman");&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;values.put("S2_R1_MI",&amp;nbsp;"Romanenko2");&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;values.put("S2_R1_LName",&amp;nbsp;"Romanenko4");&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;values.put("agreement.amount",&amp;nbsp;"1000&amp;nbsp;$");&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;values.put("agreement.amount.text",&amp;nbsp;"One&amp;nbsp;thousand&amp;nbsp;dolars");&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;StrSubstitutor&amp;nbsp;sub&amp;nbsp;=&amp;nbsp;new&amp;nbsp;StrSubstitutor(values,&amp;nbsp;"${",&amp;nbsp;"}");&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;doc.getParagraphs().forEach(p&amp;nbsp;-&gt;&amp;nbsp;{&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;p.getRuns().forEach(r&amp;nbsp;-&gt;&amp;nbsp;{&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Optional.of(r).ifPresent(run&amp;nbsp;-&gt;&amp;nbsp;{&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;String&amp;nbsp;text&amp;nbsp;=&amp;nbsp;run.getText(0);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if&amp;nbsp;(text&amp;nbsp;!=&amp;nbsp;null)&amp;nbsp;{&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;String&amp;nbsp;result&amp;nbsp;=&amp;nbsp;sub.replace(text);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;run.setText(result,&amp;nbsp;0);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;});&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;});&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;});&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;doc.write(new&amp;nbsp;FileOutputStream("/home/andrii/temp/ApachePoiExamples/TestDocWithPlaceholders_REPLACED.docx"));&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;doc.close();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br&gt;
}&lt;br&gt;
&lt;br&gt;
P.S.&amp;nbsp;Run&amp;nbsp;-&amp;nbsp;it&amp;nbsp;is&amp;nbsp;portion&amp;nbsp;of&amp;nbsp;text&amp;nbsp;with&amp;nbsp;same&amp;nbsp;properties.</questionanswer>
  </question>
</questions>
